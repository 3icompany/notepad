<link type="text/css" rel="stylesheet" href="https://source.zoom.us/2.6.0/css/bootstrap.css" />
<link type="text/css" rel="stylesheet" href="https://source.zoom.us/2.6.0/css/react-select.css" />

<body>
    <script src="https://source.zoom.us/2.6.0/lib/vendor/react.min.js"></script>
    <script src="https://source.zoom.us/2.6.0/lib/vendor/react-dom.min.js"></script>
    <script src="https://source.zoom.us/2.6.0/lib/vendor/redux.min.js"></script>
    <script src="https://source.zoom.us/2.6.0/lib/vendor/redux-thunk.min.js"></script>
    <script src="https://source.zoom.us/2.6.0/lib/vendor/lodash.min.js"></script>
    <script src="https://source.zoom.us/zoom-meeting-2.6.0.min.js"></script>
    <script>
        window.addEventListener('load', (event) => {
            console.log('checkSystemRequirements');
            console.log(JSON.stringify(ZoomMtg.checkSystemRequirements()));
            // it's option if you want to change the WebSDK dependency link resources. setZoomJSLib must be run at first
            // if (!china) ZoomMtg.setZoomJSLib('https://source.zoom.us/1.7.2/lib', '/av'); // CDN version default
            // else ZoomMtg.setZoomJSLib('https://jssdk.zoomus.cn/1.7.2/lib', '/av'); // china cdn option 
            // ZoomMtg.setZoomJSLib('http://localhost:9999/node_modules/@zoomus/websdk/dist/lib', '/av'); // Local version default, Angular Project change to use cdn version
            ZoomMtg.preLoadWasm();

            ZoomMtg.prepareJssdk();

            var SDK_KEY = window.SdkKey || '_69ffPW_SMuIZfIqo87SAQ';

            /**
             * NEVER PUT YOUR ACTUAL API SECRET IN CLIENT SIDE CODE, THIS IS JUST FOR QUICK PROTOTYPING
             * The below generateSignature should be done server side as not to expose your api secret in public
             * You can find an eaxmple in here: https://marketplace.zoom.us/docs/sdk/native-sdks/web/essential/signature
             */
            var SDK_SECRET = window.SdkSecret || 'eVxnaFdGkvfIuiU3tX1e7vaSa6XcpkOtY6QS';


            var meetConfig = {
                sdkKey: SDK_KEY,
                sdkSecret: SDK_SECRET,
                meetingNumber: window.MeetingNumber,
                userName: window.UserName,
                passWord: window.Password,
                leaveUrl: "localhost:8801",
                role: 0
            };


            // var signature = ZoomMtg.generateSignature({
            //     meetingNumber: meetConfig.meetingNumber,
            //     sdkKey: meetConfig.sdkKey,
            //     sdkSecret: meetConfig.sdkSecret,
            //     role: 1,
            //     success: function (res) {
            //         console.log(res.result);
            //     }
            // });
            function joinMeeting() {
                ZoomMtg.join(
                    {
                        meetingNumber: meetConfig.meetingNumber,
                        userName: meetConfig.userName,
                        signature: window.Signature,
                        sdkKey: meetConfig.sdkKey,
                        userEmail: 'email@gmail.com',
                        passWord: meetConfig.passWord,
                        success: function (res) {
                            console.log('join meeting success');
                            // checkUserInZoom();
                        },
                        error: function (res) {
                            console.log(res);
                        }
                    }
                );
            }
            // function rejoinAsHost() {
            //     var signature = ZoomMtg.generateSignature({
            //         meetingNumber: meetConfig.meetingNumber,
            //         sdkKey: meetConfig.sdkKey,
            //         sdkSecret: meetConfig.sdkSecret,
            //         role: 1,
            //         success: function (res) {
            //             console.log(res.result);
            //         }
            //     });
            //     function joinMeeting() {
            //         ZoomMtg.join(
            //             {
            //                 meetingNumber: meetConfig.meetingNumber,
            //                 userName: meetConfig.userName,
            //                 signature: signature,
            //                 sdkKey: meetConfig.sdkKey,
            //                 userEmail: 'email@gmail.com',
            //                 passWord: meetConfig.passWord,
            //                 success: function (res) {
            //                     console.log('join meeting success');
            //                 },
            //                 error: function (res) {
            //                     console.log(res);
            //                 }
            //             }
            //         );
            //     }
            // }
            // function checkUserInZoom() {
            //     ZoomMtg.getAttendeeslist({
            //         success: function (res) {
            //             var listUser = res.result.attendeesList;
            //             var listOther = listUser.filter(x => x.userName != meetConfig.userName);
            //             console.log(listOther);
            //             if (listOther.length == 0) {
            //                 ZoomMtg.leaveMeeting({
            //                     success: rejoinAsHost()
            //                 });
            //             }
            //         }
            //     });
            // }
            ZoomMtg.init({
                leaveUrl: 'localhost:8801',
                isSupportAV: true,
                success: function () {
                    // joinMeeting();
                },
                error: function (res) {
                    console.log(res);
                }
            });
        });
    </script>
    <style>
        .zmu-tabs__tab-bar {
            min-width: 200px !important;
        }
    </style>
</body>